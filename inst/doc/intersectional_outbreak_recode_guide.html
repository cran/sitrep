<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Guide: Intersectional Outbreak Data Recode</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Guide: Intersectional Outbreak Data
Recode</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="#purpose-of-this-guide" id="toc-purpose-of-this-guide"><span class="toc-section-number">1.1</span> Purpose of this guide</a></li>
<li><a href="#who-this-guide-is-for" id="toc-who-this-guide-is-for"><span class="toc-section-number">1.2</span> Who this guide is for</a></li>
</ul></li>
<li><a href="#instructions" id="toc-instructions"><span class="toc-section-number">2</span> Instructions</a>
<ul>
<li><a href="#structure-of-the-recoding-rmd" id="toc-structure-of-the-recoding-rmd"><span class="toc-section-number">2.1</span> Structure of the recoding
Rmd</a></li>
<li><a href="#how-to-use-the-recording-rmd" id="toc-how-to-use-the-recording-rmd"><span class="toc-section-number">2.2</span> How to use the recording
Rmd</a></li>
<li><a href="#requirements-for-this-rmd" id="toc-requirements-for-this-rmd"><span class="toc-section-number">2.3</span> Requirements for this Rmd</a></li>
</ul></li>
<li><a href="#detailed-guide" id="toc-detailed-guide"><span class="toc-section-number">3</span> Detailed guide</a>
<ul>
<li><a href="#set-up-and-loading-data" id="toc-set-up-and-loading-data"><span class="toc-section-number">3.1</span> Set up and loading data</a>
<ul>
<li><a href="#setup-chunk" id="toc-setup-chunk"><span class="toc-section-number">3.1.1</span> <code>setup</code>
chunk</a></li>
<li><a href="#import-and-inspect-data" id="toc-import-and-inspect-data"><span class="toc-section-number">3.1.2</span> Import and inspect data</a></li>
<li><a href="#understand-your-expected-data-format" id="toc-understand-your-expected-data-format"><span class="toc-section-number">3.1.3</span> Understand your expected data
format</a></li>
<li><a href="#clean_column_names-chunk" id="toc-clean_column_names-chunk"><span class="toc-section-number">3.1.4</span> <code>clean_column_names</code>
chunk</a></li>
<li><a href="#standardise_capitalisation-chunk" id="toc-standardise_capitalisation-chunk"><span class="toc-section-number">3.1.5</span>
<code>standardise_capitalisation</code> chunk</a></li>
<li><a href="#browse_data-chunk" id="toc-browse_data-chunk"><span class="toc-section-number">3.1.6</span> <code>browse_data</code>
chunk</a></li>
<li><a href="#recode_factor_vars-chunk" id="toc-recode_factor_vars-chunk"><span class="toc-section-number">3.1.7</span> <code>recode_factor_vars</code>
chunk</a></li>
<li><a href="#recode_numeric_vars-chunk" id="toc-recode_numeric_vars-chunk"><span class="toc-section-number">3.1.8</span> <code>recode_numeric_vars</code>
chunk</a></li>
<li><a href="#save_recoded_data-chunk" id="toc-save_recoded_data-chunk"><span class="toc-section-number">3.1.9</span> <code>save_recoded_data</code>
chunk</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<style>
h1:not(.title) {
background-color: #b4e1f0;
border-radius: 5px;
}
</style>
<p><em>This guide was written by Applied Epi. Feedback and suggestions
are welcome at the <a href="https://github.com/R4EPI/sitrep/issues/">GitHub issues
page</a></em></p>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="purpose-of-this-guide" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Purpose of this
guide</h2>
<p>This guide accompanies the Intersectional Outbreak Data Recode .Rmd
file, which is intended to recode data into an intersectional data
format for an outbreak report. This means that column names, classes,
values, and formats will match that of the MSF intersectional linelist.
While the code is generic, the examples in this guidance document refer
to the measles report.</p>
<p>Once the data has been recoded, the disease-specific outbreak report
.Rmd file can be used to create a report for a particular outbreak.</p>
<p><strong>Note that the Rmd file needs significant editing to be fit
for purpose</strong>. Specific cleaning code needs to be written, to
suit the raw data, the disease, and therefore the relevant data
requirements.</p>
</div>
<div id="who-this-guide-is-for" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Who this guide is
for</h2>
<p>This guide and the sitrep code is intended for <strong>individuals
who already have some familiarity R</strong> but want ready-made code to
make the report production process faster. You need to be able to edit
and troubleshoot code.</p>
</div>
</div>
<div id="instructions" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Instructions</h1>
<div id="structure-of-the-recoding-rmd" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Structure of the
recoding Rmd</h2>
<p>Running this code will clean and save your data. Knitting this .Rmd
will also produce a word document which can be kept as a log to show how
the data was changed. The sections are for:</p>
<ul>
<li>Reading in data</li>
<li>Reviewing what the data should look like (intersectional linelist
format)</li>
<li>Cleaning column names to match the intersectional format</li>
<li>Cleaning column content to match the intersectional format</li>
<li>Restructuring key columns to match the intersectional format</li>
<li>Saving the cleaned data</li>
</ul>
</div>
<div id="how-to-use-the-recording-rmd" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> How to use the
recording Rmd</h2>
<p>Each section of the code in Intersectional Outbreak Data Recode Rmd
template is explained in the ‘Detailed Guide’ section below.</p>
<p>With the help of this guide (specifically section 3), you should
recode your data by:</p>
<ol style="list-style-type: decimal">
<li><strong>Going through the Rmd file in detail and edits as needed to
make sure your data gets correctly cleaned and the code in your Rmd is
correct.</strong></li>
<li><strong>When you are happy with the Rmd code, change to
<code>eval = TRUE</code> on line 24, and click “knit” at the
top</strong>. Which will produce a document as a record of your data
cleaning process.</li>
</ol>
<p>Note there are comments to help you and refer to the relevant
sections in this guide. The comments look like this:</p>
<pre><code>&lt;!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Comments are shown between these specifically formatted lines (and will not appear in the sitrep output)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ --&gt;</code></pre>
</div>
<div id="requirements-for-this-rmd" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Requirements for this
Rmd</h2>
<p>You will need:</p>
<ul>
<li>A linelist, with the following requirements:
<ul>
<li>One row per case</li>
<li>Key columns needed for analysis: sex, age, geography, date of
notification, symptom onset date, vaccination status, illness outcome,
as well as other disease-specific columns.</li>
</ul></li>
</ul>
</div>
</div>
<div id="detailed-guide" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Detailed guide</h1>
<div id="set-up-and-loading-data" class="section level2" style="background-color: #edf3f5;  border-radius: 5px;" number="3.1">
<h2><span class="header-section-number">3.1</span> Set up and loading
data</h2>
<div id="setup-chunk" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> <code>setup</code>
chunk</h3>
<p>This chunk first sets up key preferences for this R Markdown file, in
<code>opts_chunk$set()</code>. By default it is set to not show code,
errors, or warning messages in the output.</p>
</div>
<div id="import-and-inspect-data" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Import and inspect
data</h3>
<p>The <code>read_data</code> chunk loads linelist data into RStudio.
There are six options you can pick between to load data. Delete or
comment out the code that you do not need, and make sure the code that
you do need is recognised as code (not commented-out):</p>
<ol style="list-style-type: decimal">
<li>Load data from an excel file within a specific sheet.</li>
<li>Load data from an excel file with macros (this requires
read_excel)</li>
<li>Load data from an excel file with a particular range of cells</li>
<li>Load data from an excel file within a particular sheet but also with
a password. Note this needs the installation of some additional
packages.</li>
<li>Load data from a csv file</li>
<li>Load data from a stata file</li>
</ol>
<p>When you load real data, you need to specify the right file name and
path. The placeholders assume you are working in an RStudio project, and
that the linelist is in a subfolder called <code>Data</code>.</p>
<p>The <code>inspect_data</code> chunk will show you some basic
information about your linelist: the dimensions and the column
names.</p>
</div>
<div id="understand-your-expected-data-format" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Understand your
expected data format</h3>
<p>There is no R chunk for this step, but to ensure you clean your data
correctly, make sure you are aware of the:</p>
<ul>
<li>Columns required for your outbreak report, and their column
names</li>
<li>The contents of columns, in particular the expected possible and
their spellings for categorical columns</li>
</ul>
<p>You can use the function <code>msf_dict()</code> from the
<code>{sitrep}</code> package for this. The package contains data
dictionaries and simulated datasets for measles, meningitis, AJS,
cholera, and diphtheria. The <code>msf_dict()</code> function will show
you the data dictionary for your selected disease - see the example for
measles below.</p>
<p>In this function:</p>
<ul>
<li>The data dictionary shows variable names in the
<code>variable</code> column.</li>
<li>Accepted values for each variable are specified in
<code>values_short</code> and <code>values_long columns</code>.
<code>values_short</code> has the shortened value and
<code>values_long</code> has the full-text value. You will need to
recode your current linelist values into the “values_short”
content.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">## get MSF standard dictionary for measles </span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>recode_dict <span class="ot">&lt;-</span> <span class="fu">msf_dict</span>(<span class="st">&quot;measles&quot;</span>, <span class="at">compact =</span> <span class="cn">FALSE</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;variable&quot;</span> <span class="ot">=</span> data_element_shortname, </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>         <span class="st">&quot;values_short&quot;</span> <span class="ot">=</span> option_code, </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>         <span class="st">&quot;values_long&quot;</span> <span class="ot">=</span> option_name)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="do">## browse dictionary</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">View</span>(recode_dict)</span></code></pre></div>
</div>
<div id="clean_column_names-chunk" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span>
<code>clean_column_names</code> chunk</h3>
<p>This step fixes the column names. This is done in two steps:</p>
<ol style="list-style-type: decimal">
<li>Use the <code>clean_names()</code> function from the package
<code>{janitor}</code> to automatically standardise column names as per
good coding practice (lower case, remove spaces and punctuation)</li>
<li>Manually clean column names to match linelist standard. The example
code shows some recoding for measles, e.g. we have the column
<code>sex</code> that we want to rename as <code>sex_id</code>. The
syntax for this is <code>rename(data, NEW_NAME = OLD_NAME).</code></li>
</ol>
<p>To facilitate this step, you can also use the function
<code>msf_dict_rename_helper()</code> to create a template based again
on the data dictionary held for that disease in the
<code>{sitrep}</code> package. Do this with the following steps:</p>
<ol style="list-style-type: decimal">
<li>Run <code>msf_dict_rename_helper(&quot;xxxx&quot;)</code>, where “xxxx” refers
to disease name. For instance, you can type
<code>msf_dict_rename_helper(&quot;Measles&quot;)</code>. This will copy a rename
command to your clipboard.</li>
<li>Paste the result in your code and edit to specifically rename
certain columns. Be careful! You still need to be aware of what each
variable means and what values it takes. If there are any columns that
are in the MSF dictionary that are not in your data set, then you should
comment them out, but be aware that some analyses may not run because of
this.</li>
</ol>
<p>Here is an example of what the pasted code looks like, which you can
then edit so that the name of the columns in your data is on the
right-hand side.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">## Add the appropriate column names after the equals signs</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>linelist_cleaned <span class="ot">&lt;-</span> <span class="fu">rename</span>(linelist_cleaned,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">acute_otitis_media              =</span>   , <span class="co"># BOOLEAN           (REQUIRED)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">age_days                        =</span>   , <span class="co"># INTEGER_POSITIVE  (REQUIRED)</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">age_months                      =</span>   , <span class="co"># INTEGER_POSITIVE  (REQUIRED)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">age_years                       =</span>   , <span class="co"># INTEGER_POSITIVE  (REQUIRED)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">candidiasis                     =</span>   , <span class="co"># BOOLEAN           (REQUIRED)</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">case_number                     =</span>   , <span class="co"># TEXT              (REQUIRED)</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="at">cough                           =</span>   , <span class="co"># BOOLEAN           (REQUIRED)</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="at">croup                           =</span>   , <span class="co"># BOOLEAN           (REQUIRED)</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  <span class="at">date_of_consultation_admission  =</span>   , <span class="co"># DATE              (REQUIRED)</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="at">residential_status              =</span>   , <span class="co"># TEXT              (optional)</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  <span class="at">residential_status_brief        =</span>   , <span class="co"># TEXT              (optional)</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  <span class="at">treatment_facility_name         =</span>   , <span class="co"># TEXT              (optional)</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  <span class="at">treatment_facility_site         =</span>   , <span class="co"># TEXT              (optional)</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  <span class="at">treatment_location              =</span>   , <span class="co"># ORGANISATION_UNIT (optional)</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  <span class="at">trimester                       =</span>     <span class="co"># TEXT              (optional)</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="standardise_capitalisation-chunk" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span>
<code>standardise_capitalisation</code> chunk</h3>
<p>Before browsing data, you can standardise the capitalisation of
categorical values. This minimises the number of corrections that are
needed later on in the code.</p>
</div>
<div id="browse_data-chunk" class="section level3" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span>
<code>browse_data</code> chunk</h3>
<p>You’ll want to look at your data, to know what errors and typos exist
in the column values. This chunk shows you a few ways to explore.</p>
<p>The tbl_summary() function in particular will show you all the values
within categorical columns.</p>
</div>
<div id="recode_factor_vars-chunk" class="section level3" number="3.1.7">
<h3><span class="header-section-number">3.1.7</span>
<code>recode_factor_vars</code> chunk</h3>
<p>This chunk is for recoding factor (categorical) variables. You will
need to edit this section to recode the values in your dataset to suit
the values in the expected linelist format. You can look at the data
dictionary object (<code>recode_dict</code>) and the outputs from the
<code>browse_data</code> chunk to write the correct code.</p>
<p>There is an initial example in this code which shows you how to fix
mispellings in the columns <code>sex_id</code> and <code>outcome</code>.
You should put the various incorrect spellings that need correction into
the brackets. Multiple different incorrect spellings can be listed
within the brackets. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>linelist_processing <span class="ot">&lt;-</span> linelist_processing <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_id =</span> <span class="fu">case_match</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    sex_id,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;m&quot;</span>)       <span class="sc">~</span> <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;FEMALE&quot;</span>)  <span class="sc">~</span> <span class="st">&quot;Female&quot;</span> ,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="at">.default =</span> sex_id )) <span class="sc">|&gt;</span> </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outcome =</span> <span class="fu">case_match</span>(</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    outcome,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Dead in facility - short&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Dead in facility (&lt;4h)&quot;</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Dead in facility - long&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Dead in facility (&gt;4h)&quot;</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Sent home&quot;</span>, <span class="st">&quot;Home&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Discharged home&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Death in community&quot;</span>, <span class="st">&quot;Dead in community&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Dead in community&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;DOA&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Dead on arrival&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Left&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Left against medical advice&quot;</span>,</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Transferred - MSF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Transferred (to an MSF facility)&quot;</span>,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Transferred - External&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Transferred (to External Facility)&quot;</span>,</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    <span class="at">.default =</span> outcome))</span></code></pre></div>
</div>
<div id="recode_numeric_vars-chunk" class="section level3" number="3.1.8">
<h3><span class="header-section-number">3.1.8</span>
<code>recode_numeric_vars</code> chunk</h3>
<p>This chunk will help recode numeric variables, including
restructuring the age column to be represented by two columns (age as a
number, and unit). You will need to add to it based on your dataset by
comparing to the variables in the standard data dictionary.</p>
</div>
<div id="save_recoded_data-chunk" class="section level3" number="3.1.9">
<h3><span class="header-section-number">3.1.9</span>
<code>save_recoded_data</code> chunk</h3>
<p>Save your recoded dataset as an Excel. This automatically names your
file “linelist_recoded_DATE”, where DATE is the current date. You can
now use this to use the analysis template.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
